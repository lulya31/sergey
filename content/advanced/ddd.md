---
author:
  name: "Hugo Authors"
date: 2024-07-22
linktitle: Migrating from Jekyll
title: DDD
type:
- post
- posts
weight: 10
series:
- Hugo 101
aliases:
- /blog/migrate-from-jekyll/
---

---
>[*Go Back*](http://localhost:1313/advanced/)
---

---
#### [1. Архитектура](#основные-определения)

#### [2. Монолиты](#архитектурная-часть)

#### [3. Микросервисы](#реализационная-часть)
---

# Предметно-ориентированное проектирование

### Основные определения

**DDD** (domain driven desigh) – это подход, который позволяет значительно ускорить процесс разработки программного обеспечения в незнакомой области, а также с легкостью развивать и сопровождать его в будущем.

**В чем преимущество DDD?**

- код проекта, который понятен всем участникам проектной команды;
- явная постановка задач;
- легко находятся ошибки в бизнес логике,
- при тестировании легко просматривается код и легко находятся логические ошибки;
- в будущем можно безопасно расширять и интегрировать проект.

### Архитектурная часть

1. **Знание предметной области (Domain Knowledge)**
  
Представьте, вы начали новый проект (это может быть сфера медицины, страхования или финансов) и вам необходимо собрать как можно больше информации по предметной области. Вы начинаете ее изучать и исходя из требований проекта исследуете определённую область знаний. Общение со специалистами со стороны заказчика – это необходимость в проектной разработке.

2. **Единый язык (The Ubiquitous Language)**
  
В процессе работы вы должны договориться с заказчиком на каком языке вы будете общаться, вам придется создавать единый словарь терминов и определений, которые понадобятся при проектировании архитектуры и реализации проекта. В жизненном цикле проекта словарный запас этого языка будет постоянно пополняться и расширяться из знаний предметной области.

3. **Предметная область (Problem Space)**

Определение предметной области является начальным этапом предметно-ориентированного проектирования – это главная бизнес-задача. В зависимости от сложности проекта, предметных областей может быть от одной и более.

4. **Поддомены (SubDomain), ограниченные контексты (Bounded Context)**

Начиная проектировать, вы предполагаете разделить основную бизнес-задачу на подзадачи/функции, то есть создаете поддомены в предметной области. Их также можно назвать ограниченными контекстами. Определенные логикой, они имеют четкие границы и взаимодействуют с другими ограниченными контекстами через установленные интерфейсы и контракты.

---

### Реализационная часть

Определение предметной области - главной бизнес-задачи.

После определения основного бизнес-домена следующим шагом является разделение **этого домена** (предметной области) **на поддомены** (sub-domains). Определение поддоменов по существу означает разделение различных бизнес-возможностей вашего основного бизнес-домена на связанные друг с другом элементы функциональности бизнеса.

![](/ddd/1.png)

**Ограниченные контексты** (bounded contexts) – это проектные решения для ранее определенных бизнес-доменов/поддоменов.
Можно было бы выбрать единое решение для всей предметной области в целом, т. е. единый ограниченный контекст для всех поддоменов. Но можно определить ограниченные контексты, связанные с одним или с несколькими поддоменами.

![](/ddd/2.png)
![](/ddd/3.png)

Теперь перейдем к самой важной и ответственной части процесса создания решения для предметной области – определению модели домена для ограниченного контекста. Если говорить кратко, то **модель домена** (domain model) – это реализация основной бизнес-логики внутри конкретно определенного ограниченного контекста.

На **языке бизнеса** это означает определение следующих элементов:
- бизнес-сущностей (бизнес-объектов);
- бизнес-правил;
- бизнес-потоков;
- бизнес-операций;
- бизнес-событий.

На **техническом языке**, принятом в мире предметно-ориентированного проектирования, элементы, подлежащие определению (идентификации), обозначаются следующим образом:
- агрегаты/сущности/объекты-значения;
- правила предметной области (домена);
- команды/запросы;
- события.

![](/ddd/4.png)

**Агрегат** (aggregate) (также называемый корневым агрегатом – root aggregate) – это центральный бизнес-объект в ограниченном контексте, который определяет область логической связности (целостности) внутри этого ограниченного контекста. Каждый аспект конкретного ограниченного контекста начинается и заканчивается внутри соответствующего корневого агрегата.

**Агрегат = Самый главный идентификатор конкретного ограниченного контекста**

**Объекты-сущности** (entity objects), или просто сущности (entity), обладают собственной идентичностью, но не могут существовать вне корневого агрегата, т. е. сущности создаются при создании корневого агрегата и уничтожаются при уничтожении корневого агрегата.

**(Объекты)-сущности = Вторичные идентификаторы конкретного ограниченного контекста**

**Объекты-значения** (value objects) не обладают собственной идентичностью и с легкостью заменяемы в любом экземпляре корневого агрегата или сущности.

![](/ddd/5.png)

**Правила предметной области (домена)** – это, по существу, определения бизнес-правил. Правила предметной области, также моделируемые как объекты, способствуют выполнению агрегатом любого типа бизнес-логики в области соответствующего ограниченного контекста.

![](/ddd/6.png)

**Команды/запросы**
Команды (commands) и запросы (queries) представляют любой **тип операций** в ограниченном контексте, которые либо воздействуют на состояние агрегата/сущности, либо запрашивают состояние агрегата/сущности.

![](/ddd/7.png)

**События**
События (events) содержат любые типы изменения состояния как агрегата, так и сущности в ограниченном контексте.

![](/ddd/8.png)

**Саги**

Последним элементом модели предметно-ориентированного проектирования является прогон любого типа бизнес-процессов/бизнес-потоков внутри конкретного бизнес-домена. Такой прогон в предметно-ориентированном проектировании обозначается термином сага (saga). 

Рассмотрим пример саги в уже знакомой нам предметной области автофинансирования – открытии кредитного счета.
Общая схема бизнес-процесса для открытия кредитного счета описана ниже.
1. Клиент передает заявку на кредит (Loan Application) в компанию X Auto Finance с целью приобретения нового автомобиля.
2. Компания X Auto Finance проверяет (выполняет валидацию) подробные данные этой заявки на кредит, чтобы предоставить наилучшие условия кредитования (Loan Product) клиенту.
3. Компания X Auto Finance либо утверждает заявку, либо отказывает клиенту в выдаче кредита.
4. Если заявка утверждена, то компания X Auto Finance представляет клиенту условия кредитования (Loan Product Terms), включая процентную ставку, срок владения (погашения) и т. д.
5. Клиент принимает условия кредитования.
6. Компания X Auto Finance окончательно утверждает заявку после согласования с клиентом.
7. Компания X Auto Finance открывает новый кредитный счет (Loan Account) для этого клиента.

Вполне очевидно, что этот бизнес-процесс включает несколько ограниченных контекстов, т. е. начинается с ограниченного контекста первоначальных выплат (утверждение заявки на кредит), заканчивается в ограниченном кон- тексте обслуживания (открытие кредитного счета). 

![](/ddd/9.png)


https://doc-exploitation-dev.com-dev.int.rolfcorp.ru/01_entities/


---